import{f as M,p as R,h as q,T as V,U as G,g as J,o as K}from"./format-page-title-d2ff14dd.js";import{_ as U,a as X,O as Q,d as z}from"./store-afb7c6c1.js";function Te(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=R(t);return M(t,r)}var Z=Array.isArray;function Y(t,e){return Z(e)?t.apply(void 0,U([],X(e))):t(e)}function ee(t){return q(function(e){return Y(t,e)})}var re=Array.isArray,te=Object.getPrototypeOf,ne=Object.prototype,ae=Object.keys;function ie(t){if(t.length===1){var e=t[0];if(re(e))return{args:e,keys:null};if(le(e)){var r=ae(e);return{args:r.map(function(n){return e[n]}),keys:r}}}return{args:t,keys:null}}function le(t){return t&&typeof t=="object"&&te(t)===ne}function se(t,e){return t.reduce(function(r,n,i){return r[n]=e[i],r},{})}function we(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=R(t),n=V(t),i=ie(t),s=i.args,a=i.keys;if(s.length===0)return M([],r);var l=new Q(fe(s,r,a?function(f){return se(a,f)}:z));return n?l.pipe(ee(n)):l}function fe(t,e,r){return r===void 0&&(r=z),function(n){D(e,function(){for(var i=t.length,s=new Array(i),a=i,l=i,f=function(u){D(e,function(){var c=M(t[u],e),b=!1;c.subscribe(J(n,function(p){s[u]=p,b||(b=!0,l--),l||n.next(r(s.slice()))},function(){--a||n.complete()}))},n)},o=0;o<i;o++)f(o)},n)}}function D(t,e,r){t?G(r,t,e):e()}function xe(t){return K(function(e,r){try{e.subscribe(r)}finally{r.add(t)}})}function A(t){if(typeof t!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(t))}function F(t,e){for(var r="",n=0,i=-1,s=0,a,l=0;l<=t.length;++l){if(l<t.length)a=t.charCodeAt(l);else{if(a===47)break;a=47}if(a===47){if(!(i===l-1||s===1))if(i!==l-1&&s===2){if(r.length<2||n!==2||r.charCodeAt(r.length-1)!==46||r.charCodeAt(r.length-2)!==46){if(r.length>2){var f=r.lastIndexOf("/");if(f!==r.length-1){f===-1?(r="",n=0):(r=r.slice(0,f),n=r.length-1-r.lastIndexOf("/")),i=l,s=0;continue}}else if(r.length===2||r.length===1){r="",n=0,i=l,s=0;continue}}e&&(r.length>0?r+="/..":r="..",n=2)}else r.length>0?r+="/"+t.slice(i+1,l):r=t.slice(i+1,l),n=l-i-1;i=l,s=0}else a===46&&s!==-1?++s:s=-1}return r}function ce(t,e){var r=e.dir||e.root,n=e.base||(e.name||"")+(e.ext||"");return r?r===e.root?r+n:r+t+n:n}var E={resolve:function(){for(var e="",r=!1,n,i=arguments.length-1;i>=-1&&!r;i--){var s;i>=0?s=arguments[i]:(n===void 0&&(n=process.cwd()),s=n),A(s),s.length!==0&&(e=s+"/"+e,r=s.charCodeAt(0)===47)}return e=F(e,!r),r?e.length>0?"/"+e:"/":e.length>0?e:"."},normalize:function(e){if(A(e),e.length===0)return".";var r=e.charCodeAt(0)===47,n=e.charCodeAt(e.length-1)===47;return e=F(e,!r),e.length===0&&!r&&(e="."),e.length>0&&n&&(e+="/"),r?"/"+e:e},isAbsolute:function(e){return A(e),e.length>0&&e.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var e,r=0;r<arguments.length;++r){var n=arguments[r];A(n),n.length>0&&(e===void 0?e=n:e+="/"+n)}return e===void 0?".":E.normalize(e)},relative:function(e,r){if(A(e),A(r),e===r||(e=E.resolve(e),r=E.resolve(r),e===r))return"";for(var n=1;n<e.length&&e.charCodeAt(n)===47;++n);for(var i=e.length,s=i-n,a=1;a<r.length&&r.charCodeAt(a)===47;++a);for(var l=r.length,f=l-a,o=s<f?s:f,u=-1,c=0;c<=o;++c){if(c===o){if(f>o){if(r.charCodeAt(a+c)===47)return r.slice(a+c+1);if(c===0)return r.slice(a+c)}else s>o&&(e.charCodeAt(n+c)===47?u=c:c===0&&(u=0));break}var b=e.charCodeAt(n+c),p=r.charCodeAt(a+c);if(b!==p)break;b===47&&(u=c)}var y="";for(c=n+u+1;c<=i;++c)(c===i||e.charCodeAt(c)===47)&&(y.length===0?y+="..":y+="/..");return y.length>0?y+r.slice(a+u):(a+=u,r.charCodeAt(a)===47&&++a,r.slice(a))},_makeLong:function(e){return e},dirname:function(e){if(A(e),e.length===0)return".";for(var r=e.charCodeAt(0),n=r===47,i=-1,s=!0,a=e.length-1;a>=1;--a)if(r=e.charCodeAt(a),r===47){if(!s){i=a;break}}else s=!1;return i===-1?n?"/":".":n&&i===1?"//":e.slice(0,i)},basename:function(e,r){if(r!==void 0&&typeof r!="string")throw new TypeError('"ext" argument must be a string');A(e);var n=0,i=-1,s=!0,a;if(r!==void 0&&r.length>0&&r.length<=e.length){if(r.length===e.length&&r===e)return"";var l=r.length-1,f=-1;for(a=e.length-1;a>=0;--a){var o=e.charCodeAt(a);if(o===47){if(!s){n=a+1;break}}else f===-1&&(s=!1,f=a+1),l>=0&&(o===r.charCodeAt(l)?--l===-1&&(i=a):(l=-1,i=f))}return n===i?i=f:i===-1&&(i=e.length),e.slice(n,i)}else{for(a=e.length-1;a>=0;--a)if(e.charCodeAt(a)===47){if(!s){n=a+1;break}}else i===-1&&(s=!1,i=a+1);return i===-1?"":e.slice(n,i)}},extname:function(e){A(e);for(var r=-1,n=0,i=-1,s=!0,a=0,l=e.length-1;l>=0;--l){var f=e.charCodeAt(l);if(f===47){if(!s){n=l+1;break}continue}i===-1&&(s=!1,i=l+1),f===46?r===-1?r=l:a!==1&&(a=1):r!==-1&&(a=-1)}return r===-1||i===-1||a===0||a===1&&r===i-1&&r===n+1?"":e.slice(r,i)},format:function(e){if(e===null||typeof e!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof e);return ce("/",e)},parse:function(e){A(e);var r={root:"",dir:"",base:"",ext:"",name:""};if(e.length===0)return r;var n=e.charCodeAt(0),i=n===47,s;i?(r.root="/",s=1):s=0;for(var a=-1,l=0,f=-1,o=!0,u=e.length-1,c=0;u>=s;--u){if(n=e.charCodeAt(u),n===47){if(!o){l=u+1;break}continue}f===-1&&(o=!1,f=u+1),n===46?a===-1?a=u:c!==1&&(c=1):a!==-1&&(c=-1)}return a===-1||f===-1||c===0||c===1&&a===f-1&&a===l+1?f!==-1&&(l===0&&i?r.base=r.name=e.slice(1,f):r.base=r.name=e.slice(l,f)):(l===0&&i?(r.name=e.slice(1,a),r.base=e.slice(1,f)):(r.name=e.slice(l,a),r.base=e.slice(l,f)),r.ext=e.slice(a,f)),l>0?r.dir=e.slice(0,l-1):i&&(r.dir="/"),r},sep:"/",delimiter:":",win32:null,posix:null};E.posix=E;var C=E;/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function oe(t){return`data:image/gif;ttu:${t};base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==`}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ue(t){const e=(r,n)=>{const i=r.getAttribute(n);i&&!(i.startsWith("ttu:")||i.startsWith("data:image/gif;ttu:"))&&(r.setAttribute(`data-ttu-${n}`,i),r.removeAttribute(n))};Array.from(t.getElementsByTagName("image")).forEach(r=>{e(r,"href")}),Array.from(t.getElementsByTagName("img")).forEach(r=>{e(r,"src")})}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function de(t){Array.from(t.getElementsByTagName("image")).filter(e=>!e.getAttributeNames().some(r=>r==="href")).forEach(e=>{const r=Array.from(e.attributes).find(n=>n.name.endsWith("href"));!r||e.setAttribute("href",r.value)})}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ge(t){return Array.from(t.classList).some(e=>e.includes("gaiji"))}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function I(t){return t instanceof HTMLImageElement?ge(t):!1}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function me(t){return I(t)?1:ve(t)}const he=/[^0-9A-Z○◯々-〇〻ぁ-ゖゝ-ゞァ-ヺー０-９Ａ-Ｚｦ-ﾝ\p{Radical}\p{Unified_Ideograph}]+/gimu;function ve(t){return t.textContent?Ae(t.textContent.replace(he,"")):0}function Ae(t){return Array.from(t).length}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */function ye(t){return W(t,e=>!(e.nodeName==="RT"||e instanceof HTMLElement&&(e.attributes.getNamedItem("aria-hidden")||e.attributes.getNamedItem("hidden")))).filter(e=>{var r;return!!(I(e)||(r=e.textContent)!=null&&r.replace(/\s/g,"").length)})}function W(t,e){return!t.hasChildNodes()||!e(t)?[]:Array.from(t.childNodes).flatMap(r=>r.nodeType===Node.TEXT_NODE?[r]:I(r)?[r]:W(r,e)).filter(e)}/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */const S="ttu-";function Oe(t,e,r){let n={type:3,content:""},i="";const s=e.package.manifest.item.reduce((g,d)=>(d["@_media-type"]==="application/xhtml+xml"&&(g[d["@_id"]]=d["@_href"],d["@_properties"]==="nav"&&(i=d["@_href"])),g),{}),a=Object.entries(t).reduce((g,[d,h])=>{const m=d.endsWith(".ncx")&&!n.content;return(m||i===d)&&(n={type:m?2:3,content:h}),h instanceof Blob&&g.push(d),g},[]),l=new DOMParser,f=Array.isArray(e.package.spine.itemref)?e.package.spine.itemref:[e.package.spine.itemref],o=[],u=r.createElement("div");let c=[],b=-1;if(n.type&&n.content){let g=l.parseFromString(n.content,"text/html");if(n.type===3){let d=g.querySelector('nav[epub\\:type="toc"],nav#toc');d||(g=l.parseFromString(n.content,"text/xml")),d=g.querySelector('nav[epub\\:type="toc"],nav#toc'),d&&(c=[...d.querySelectorAll("a")].map(h=>{const m=h;return{reference:m.href,charactersWeight:1,label:m.innerText}}))}else c=[...g.querySelectorAll("navPoint")].map(d=>{const h=d.querySelector("navLabel text");return{reference:d.querySelector("content").getAttribute("src"),charactersWeight:1,label:h.innerText}})}c.length&&(b=f.findIndex(g=>c[0].reference.includes(s[g["@_idref"].split("/").pop()||""])),b!==0&&c.unshift({reference:s[f[0]["@_idref"]],charactersWeight:1,label:"Preface",startCharacter:0}));let p=c[0],y=p?`${S}${f[0]["@_idref"]}`:"",T=0,L=0,x=0;return f.forEach(g=>{var j,B;const d=g["@_idref"],h=s[d],m=/.*<body(?:[^>]*id="(?<id>.+?)")*[^>]*>(?<body>(.|\s)+)<\/body>.*/.exec(t[h]),N=((j=m==null?void 0:m.groups)==null?void 0:j.id)||"";let O=((B=m==null?void 0:m.groups)==null?void 0:B.body)||"";a.forEach(v=>{O=O.replaceAll(Ce(h,v),oe(v))});const k=r.createElement("div");if(k.innerHTML=O,k.id=`${S}${d}`,N){const v=r.createElement("span");v.id=N,k.prepend(v)}u.appendChild(k),x+=be(k);const H=c.findIndex(v=>v.reference.includes(h.split("/").pop()||"")),P=H>-1?c[H]:void 0,w=x-L;if(P){const v=T;p=P,T=o.length,y=`${S}${d}`,o.push({reference:y,charactersWeight:w||1,label:p.label,startCharacter:T?o[v].startCharacter+o[v].characters:0,characters:w})}else p&&(o[T].characters+=w,o.push({reference:`${S}${d}`,charactersWeight:w||1,parentChapter:y}));L=x}),ue(u),de(u),pe(u),{element:u,sections:o.filter(g=>g.reference.startsWith(S))}}function be(t){const e=ye(t);let r=0;return e.forEach(n=>{r+=me(n)}),r}function pe(t){Array.from(t.getElementsByTagName("a")).forEach(e=>{const r=e.getAttribute("href");!r||e.setAttribute("href",`#${r.replace(/.+#/,"")}`)})}function Ce(t,e){const r=C.dirname(t),n=C.dirname(e),i=C.basename(e);if(r===n)return i;const s=r==="."?[]:r.split("/"),a=n==="."?[]:n.split("/");if(s.length>=a.length){for(let l=0;l<s.length;l+=1)if(s[l]!==a[l])return C.join("../".repeat(s.length-l)+a.slice(l).join("/"),i)}for(let l=0;l<s.length;l+=1)if(s[l]!==a[l])return C.join("../".repeat(s.length-l)+a.slice(l).join("/"),i);return C.join(a.slice(s.length-a.length).join("/"),i)}/*!
 * Font Awesome Free 6.1.1 by @fontawesome - https://fontawesome.com
 * License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License)
 * Copyright 2022 Fonticons, Inc.
 */var Me={prefix:"far",iconName:"bookmark",icon:[384,512,[61591,128278],"f02e","M336 0h-288C21.49 0 0 21.49 0 48v431.9c0 24.7 26.79 40.08 48.12 27.64L192 423.6l143.9 83.93C357.2 519.1 384 504.6 384 479.9V48C384 21.49 362.5 0 336 0zM336 452L192 368l-144 84V54C48 50.63 50.63 48 53.1 48h276C333.4 48 336 50.63 336 54V452z"]},Ie={prefix:"far",iconName:"image",icon:[512,512,[],"f03e","M152 120c-26.51 0-48 21.49-48 48s21.49 48 48 48s48-21.49 48-48S178.5 120 152 120zM447.1 32h-384C28.65 32-.0091 60.65-.0091 96v320c0 35.35 28.65 64 63.1 64h384c35.35 0 64-28.65 64-64V96C511.1 60.65 483.3 32 447.1 32zM463.1 409.3l-136.8-185.9C323.8 218.8 318.1 216 312 216c-6.113 0-11.82 2.768-15.21 7.379l-106.6 144.1l-37.09-46.1c-3.441-4.279-8.934-6.809-14.77-6.809c-5.842 0-11.33 2.529-14.78 6.809l-75.52 93.81c0-.0293 0 .0293 0 0L47.99 96c0-8.822 7.178-16 16-16h384c8.822 0 16 7.178 16 16V409.3z"]};/**
 * @license BSD-3-Clause
 * Copyright (c) 2022, ッツ Reader Authors
 * All rights reserved.
 */class Ee{constructor(e){this.document=e,this.fallbackSpec=_(this.document)}get fullscreenEnabled(){var e;return(e=this.fallbackSpec("fullscreenEnabled","webkitFullscreenEnabled"))!=null?e:!1}get fullscreenElement(){var e;return(e=this.fallbackSpec("fullscreenElement","webkitFullscreenElement"))!=null?e:null}async requestFullscreen(e,r){const n=_(e)("requestFullscreen","webkitRequestFullscreen");!n||await n(r)}async exitFullscreen(){const e=this.fallbackSpec("exitFullscreen","webkitExitFullscreen");!e||await e()}}function _(t){return(e,r)=>{var n;return(n=$(t,e))!=null?n:$(t,r)}}function $(t,e){const r=t[e];return typeof r=="function"?r.bind(t):r}const Le=new Ee(document);export{me as a,oe as b,we as c,xe as d,Le as e,Me as f,ye as g,Ie as h,ge as i,C as j,Oe as k,ue as l,ee as m,de as n,Te as o,S as p};
